<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Bank Renege · SimJulia.jl documentation</title><link href="../assets/documenter.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.2.0/require.min.js" data-main="../assets/documenter.js"></script></head><body><nav class="toc"><h1>SimJulia.jl</h1><form class="search" action="../search.html"><input id="search-query" name="q" type="text" placeholder="Search docs"/></form><ul><li><a class="toctext" href="../index.html">Home</a></li><li><span class="toctext">Intro</span><ul><li><a class="toctext" href="../10_min/1_installation.html">Installation</a></li><li><a class="toctext" href="../10_min/2_basic_concepts.html">Basic Concepts</a></li><li><a class="toctext" href="../10_min/3_process_interaction.html">Process Interaction</a></li></ul></li><li><a class="toctext" href="../topics.html">Manual</a></li><li><span class="toctext">Examples</span><ul><li class="current"><a class="toctext" href="1_bank_renege.html">Bank Renege</a><ul class="internal"></ul></li></ul></li><li><a class="toctext" href="../api.html">Library</a></li></ul></nav><article id="docs"><header><nav><ul><li>Examples</li><li><a href="1_bank_renege.html">Bank Renege</a></li></ul><a class="edit-page" href="https://github.com/BenLauwens/SimJulia.jl/tree/da865b575d4afd36b7850e712723927d92be5794/docs/src/examples/1_bank_renege.md"><span class="fa"></span> Edit on GitHub</a></nav><hr/></header><h1><a class="nav-anchor" id="Bank-Renege-1" href="#Bank-Renege-1">Bank Renege</a></h1><p>Covers:</p><ul><li><p>Resources</p></li><li><p>Event operators</p></li></ul><p>A counter with a random service time and customers who renege.</p><p>This example models a bank counter and customers arriving at random times. Each customer has a certain patience. It waits to get to the counter until she’s at the end of her tether. If she gets to the counter, she uses it for a while.</p><p>New customers are created by the source process every few time steps.</p><pre><code class="language-">using SimJulia
using Distributions

const RANDOM_SEED = 150
const NEW_CUSTOMERS = 5  # Total number of customers
const INTERVAL_CUSTOMERS = 10.0  # Generate new customers roughly every x seconds
const MIN_PATIENCE = 1.0  # Min. customer patience
const MAX_PATIENCE = 3.0  # Max. customer patience

function source(sim::Simulation, number::Int, interval::Float64, counter::Resource)
  d = Exponential(interval)
  for i in 1:number
    Process(customer, sim, &quot;Customer $i&quot;, counter, 12.0)
    yield(Timeout(sim, rand(d)))
  end
end

function customer(sim::Simulation, name::String, counter::Resource, time_in_bank::Float64)
  arrive = now(sim)
  println(&quot;$arrive $name: Here I am&quot;)
  Request(counter) do req
    patience = rand(Uniform(MIN_PATIENCE, MAX_PATIENCE))
    yield(req | Timeout(sim, patience))
    wait = now(sim) - arrive
    if state(req) == SimJulia.triggered
      println(&quot;$(now(sim)) $name: Waited $wait&quot;)
      yield(Timeout(sim, rand(Exponential(time_in_bank))))
      println(&quot;$(now(sim)) $name: Finished&quot;)
    else
      println(&quot;$(now(sim)) $name: RENEGED after $wait&quot;)
    end
  end
end

# Setup and start the simulation
println(&quot;Bank renege&quot;)
srand(RANDOM_SEED)
sim = Simulation()

# Start processes and run
counter = Resource(sim, 1)
Process(source, sim, NEW_CUSTOMERS, INTERVAL_CUSTOMERS, counter)
run(sim)</code></pre><footer><hr/><a class="previous" href="../topics.html"><span class="direction">Previous</span><span class="title">Manual</span></a><a class="next" href="../api.html"><span class="direction">Next</span><span class="title">Library</span></a></footer></article></body></html>
